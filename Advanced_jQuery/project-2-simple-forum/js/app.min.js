"use strict";!function(t){function e(e,n){this.config=t.extend({},o,n),this.element=e,this.element.data("timeago",this),this.init()}var o={},n=function(t){var e=t.attr("date");if(!e&&t.text()&&(e=t.text()),!e)throw t;return e};e.prototype.init=function(){console.log("timeago initiated"),this.date=n(this.element),this.dateMoment=moment(this.date),this.render()},e.prototype.render=function(){var t=this.dateMoment.fromNow();this.element.text(t);var e=this;return this.renderTimeout=setTimeout(function(){e.render()},1e3),this},e.prototype.stop=function(){return this.renderTimeout&&clearTimeout(this.renderTimeout),this},t.fn.timeago=function(o){return this.each(function(){var n,i=t(this);(n=i.data("timeago"))?"string"==typeof o&&"function"==typeof n[o]?n[o]():console.warn("Timeago already initialized on",this,"and",o,"is not a valid instance method"):new e(i,o)}),this}}(jQuery);var currentUser={id:76,name:"Sam Chittenden",username:"Sam",email:"sam@chittenden.com",address:{street:"1000 Diamond Lane",suite:"",city:"Amazingtown",zipcode:"12345",geo:{lat:"-32.8129",lng:"68.5342"}},phone:"(123)456-1234",website:"super.co.ol",company:{name:"Amazeballs Inc",catchPhrase:"That is Amazeballs",bs:"Don't just amaze, Amazeballs"}};!function(t,e,o){function n(){p.users.push(o);var n={};n.posts=p.posts?i(p.posts):[];var s=e.compile(m);e.registerPartial("postItem",s);var u=e.compile(a)(n);r.html(u);var d=e.compile(c)(n);l.html(d),t(document).trigger("templateComplete")}function i(t){for(var e=[],o=t.length,n=0;n<50;){var i=Math.floor(Math.random()*o);-1===e.indexOf(i)&&(e.push(i),n++)}return e.map(function(e){return t[e]})}var s="https://jsonplaceholder.typicode.com/",r=t("#posts"),a=t("#posts-template").html(),m=t("#post-item-partial").html(),l=t("#recent-activity"),c=t("#recent-activity-template").html(),p={users:null,posts:null,comments:null},u=t.get(s+"users",function(t){p.users=t}),d=t.get(s+"posts",function(t){p.posts=t}),f=t.get(s+"comments",function(t){p.comments=t});t.when(u,d,f).done(function(){n()}),e.registerHelper("userID",function(t,e){return p.users.filter(function(e){return e.id===t})[0].name}),e.registerHelper("getComments",function(t,e){this.comments=p.comments.filter(function(e){return e.postId===t})}),e.registerHelper("getRecent",function(t,e){var o=t[Math.floor(50*Math.random())];return e.fn(o)}),e.registerHelper("getComment",function(t,e){if(void 0!==t)return t[Math.floor(Math.random()*t.length)][e]}),e.registerHelper("newDate",function(){return(new Date).toISOString()})}(jQuery,Handlebars,currentUser),function(t,e,o){function n(){if(event.preventDefault(),""!==t("#new-post__title").val()){var e={};e.title=t("#new-post__title").val(),e.body=t("#new-post__body").val(),e.userId=o.id,e.id=p,e.name=o.name;var n=m(e);t(".forum__post-list").prepend(n),p++,t("body").animate({scrollTop:0},400),t("#new-post__title, #new-post__body").val("")}else alert("Oops! You didn't post anything.")}function i(){var e=new Date,n=t(this).siblings(".comment-submission"),i={};i.body=n.val(),i.postTitle=t(this).parents().contents(".forum__post-title").text(),i.email=o.email,i.id=t(this).parents().contents(".forum__post-title").attr("data-post-id"),i.date=e,""!==i.body&&(t(this).parent().before('<li class="forum__comments-item"><p>'+i.body+"</p></li>"),t("#recent-activity").append(c(i))),t(".timestamp").last().text(e.toISOString()).timeago(),n.val("")}function s(){var e=t(this).parent().attr("data-post-id");r(t(".forum__post-title[data-post-id="+e+"]"))}function r(e){t(".forum__post-item").removeClass("--is-active"),t(".forum__post-body").slideUp(400),t(".forum__comments-list").slideUp(300),e.parent().find(".forum__post-body").slideToggle(300),e.parent().toggleClass("--is-active"),t("body").animate({scrollTop:e.offset().top-.4*t(window).height()},400)}var a=t("#post-item-from-form").html(),m=e.compile(a),l=t("#recent-comment-partial").html(),c=e.compile(l),p=101;t(document).on("templateComplete",function(){t(".timestamp").timeago();var e=t(".forum__post-list");e.on("click",".forum__post-title",function(){t(".forum__post-item").removeClass("--is-active"),t(".forum__post-body").filter(function(){return t(this).closest(".forum__post-title")!==event.target}).slideUp(400),t(".forum__comments-list").slideUp(300),t(this).parent().find(".forum__post-body").slideToggle(300),t(this).parent().toggleClass("--is-active"),t("body").animate({scrollTop:t(this).offset().top-.4*t(window).height()},400)}),t(".forum__post-body").on("click",function(){t(this).slideToggle(300),t(this).parent().removeClass("--is-active")}),e.on("click",".comments-toggle",function(){t(this).closest(".forum__comments").find(".forum__comments-list").slideToggle(300)}),e.on("click",".close-icon",function(){t(".forum__post-item").removeClass("--is-active"),t(this).parent().find(".forum__post-body").slideToggle(300),t(".forum__comments-list").slideUp(300),t(this).parent().removeClass("--is-active")}),t("#new-post__title, #new-post__body").on("focus",function(){t(".left-sidebar").addClass("--is-expanded")}),t("#new-post__title, #new-post__body").on("blur",function(){t(".left-sidebar").removeClass("--is-expanded")}),t("#new-post-form").submit(n),t("#posts").on("click",".comment-submit",i),t("#recent-activity").on("click",".recent-post__title",s)})}(jQuery,Handlebars,currentUser);