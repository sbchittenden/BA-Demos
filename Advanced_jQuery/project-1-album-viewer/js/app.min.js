"use strict";!function(t){function e(e,l){this.config=t.extend({},o,l),this.element=e,this.init()}var o={albumsURL:"https://jsonplaceholder.typicode.com/albums",photosURL:"https://jsonplaceholder.typicode.com/photos",albumData:{},currentAlbums:{albums:[],photos:[]},albumsPerPage:20,currentAlbumIndex:0};e.prototype.init=function(){this._getAlbums(),this._getPhotos(),this._populateAlbumGrid()},e.prototype._getAlbums=function(){var e=this;t.ajax({url:this.config.albumsURL,method:"GET"}).done(function(t){e.config.albumData.albums=t},function(){console.log("_getAlbums GET has failed")})},e.prototype._getPhotos=function(){var e=this;t.ajax({url:this.config.photosURL,method:"GET"}).done(function(t){e.config.albumData.photos=t},function(){console.log("_getPhotos GET has failed")})},e.prototype._populateAlbumGrid=function(){var e=this;t(document).ajaxStop(function(){var o=e.config;t(".preloader").fadeOut(3e3);for(var l=0;l<o.albumsPerPage;l++)o.currentAlbums.albums.push(o.albumData.albums[l]);o.currentAlbums.photos=o.albumData.photos.filter(function(t){return t.albumId<=o.albumsPerPage}),o.currentAlbumIndex=o.albumsPerPage;var a=o.template(o.currentAlbums);e.element.html(a),e.element.lightbox({photos:o.currentAlbums.photos,galleryTemplate:o.galleryTemplate}),e._makeNextButton()})},e.prototype._makeNextButton=function(){var e=this;this.element.after('<div class="page-controls"><div class="button">show more albums</div></div>'),t(".page-controls").on("click",function(){e._getNextPage()})},e.prototype._getNextPage=function(){var e=this,o=this.config;o.currentAlbums.albums.length=0,o.currentAlbums.photos.length=0,this.element.fadeOut(200),t(".preloader").fadeIn(300),setTimeout(function(){if(t("body").scrollTop(0),o.currentAlbumIndex<=o.albumData.albums.length-o.albumsPerPage){for(var l=0;l<o.albumsPerPage;l++)o.currentAlbums.albums.push(o.albumData.albums[l+o.currentAlbumIndex]);o.currentAlbums.photos=o.albumData.photos.filter(function(t){return t.albumId>o.currentAlbumIndex&&t.albumId<=o.currentAlbumIndex+o.albumsPerPage});o.currentAlbums.photos;e.element.lightbox({photos:o.currentAlbums.photos,galleryTemplate:o.galleryTemplate}),o.currentAlbumIndex+=o.albumsPerPage;var a=o.template(o.currentAlbums);e.element.html(a),e.element.fadeIn(200),t(".preloader").fadeOut(3e3)}else t(".page-controls > .button").html("that's all folks!"),e.element.fadeIn(200),t(".preloader").fadeOut(1e3),console.log("that's all folks!")},1e3)},t.fn.albumGrid=function(t){return new e(this,t),this}}(jQuery),function(t){t.fn.buildGrid=function(e){return this.each(function(){function o(){console.log(l)}var l={albums:null,photos:null};t.ajax({url:e+"/albums",method:"GET"}).then(function(t){console.log("album data",t),l.albums=t}).then(t.get(e+"/photos",function(t){console.log("photos data",t),l.photos=t,o()}))})}}(jQuery),function(t){function e(e,o){this.config=t.extend({},l,o),this.element=e,a=this.config,this.init()}function o(e){t(".photo-gallery__list").on("click",".photo-gallery__thumb",function(e){var o=e.target.dataset.largeImageUrl,l=""+e.target.dataset.title;t(".current-image").removeClass("--is-current").addClass("--is-shrinking").on("animationend",function(){t(".current-image > img").attr({src:o}),t(".current-image > p").html(l),t(this).addClass("--is-current").removeClass("--is-shrinking")})}),t(".close-lightbox").on("click",function(e){t(".lightbox-modal").removeClass("--is-visible")})}var l={},a={};e.prototype.init=function(){var t=this.config.galleryTemplate;this.config.photos;this.element.on("click",".album",a,this._openLightbox)},e.prototype._openLightbox=function(e){var l=parseInt(e.currentTarget.dataset.albumId),n={};n.photos=a.photos.filter(function(t){return t.albumId===l});var r=a.galleryTemplate(n),u=t(".lightbox-modal");u.html(r);var s=n.photos[0].url,i=n.photos[0].title;t(".current-image > img").attr({src:s}),t(".current-image > p").html(i),u.addClass("--is-visible"),o()},t.fn.lightbox=function(t){return new e(this,t),this}}(jQuery),function(t,e){var o=t("#album-grid-template").html(),l=e.compile(o),a=t("#photo-gallery-template").html(),n=e.compile(a);t(".album-grid").albumGrid({template:l,galleryTemplate:n}),e.registerHelper("albumCover",function(t,e){for(var o=e.data.root.photos,l=Math.round(99*Math.random()),a=0;a<o.length;a++)if(o[a].albumId===t)return o[l].thumbnailUrl})}(jQuery,Handlebars);